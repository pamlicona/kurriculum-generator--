<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu-light.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="app-styles.html">



<dom-module id="my-summary">
  <template>
    <style include="app-styles">
      :host {
          margin-top: 10%;
      }

      .section-basic-data {
        display: flex;
        justify-content: space-between;
        text-align: right;
      }

      .formPrint {
        display: grid;
        justify-content: center;
        grid-template-columns: 1fr 2fr 2fr 1fr;
        margin-bottom: 50px;
      }

      .content {
        grid-template-columns: 1fr 2fr;
        display: grid;
        column-gap: 10px;
        background-color: white;
        min-height: 1447px;
      }

      .text_bold {
        font-weight: bold;
      }

      .left_column {
        background-color: rgb(255, 121, 0);
        padding: 23px 30px 0 30px;
        align-items: center;
        display: block;
      }

      .section {
        margin: 0 0 35% 0;
      }

      .section p {
        color: white;
        font-weight: 100;
      }

      .section_photo {
        text-align: center;
        background-color: white;
        max-width: 100%;
        min-height: 350px;
      }

      .title_info-lf {
        font-size: 22px;
        color: #424242;
        font-weight: 100;
      }

      .gray_division {
        max-width: 15%;
        min-height: 5px;
        background: #585858;
      }

      .right_column {
        margin-top: 10%;
        padding-left: 3%;
      }

      .section_basic-data {
        display: flex !important;
        justify-content: space-around;
        text-align: right;
        margin-bottom: 10%;
      }

      .section_presentation h1 {
        font-weight: 100;
        font-size: 30px;
      }

      .orange_division {
        height: 4px;
        background-color: rgb(255, 121, 0);
        max-width: 15%;
        margin: 30px 0 30px 0;
      }

      .color_profile {
        color: gray;
      }

      .color_Agile {
        color: #01DFA5 !important;
      }

      .color_Development {
        color: #2ECCFA !important;
      }

      .color_DevOps {
        color: #086A87 !important;
      }

      .color_UX {
        color: #CC2EFA !important;
      }

      .division_profile {
        height: 20px;
        background-color: grey;
      }

      .division_Agile {
        background-color: #01DFA5 !important;
      }

      .division_Development {
        background-color: #2ECCFA !important;
      }

      .division_DevOps {
        background-color: #086A87 !important;
      }

      .division_UX {
        background-color: #CC2EFA !important;
      }

      .title_info {
        font-size: 25px;
        font-weight: 200;
      }

      .grid_two_columns {
        display: grid;
        grid-template-columns: 2fr 2fr;
        font-size: 17px;
        grid-column-gap: 25px;
      }

      .grid_section_rows {
        grid-template-rows: 1fr 1fr;
        display: grid;
      }

      .grid_start_second_column {
        grid-column-start: 2;
      }

      .color_gray {
        color: #848484;
      }

      .space_element {
        margin: 6% 0 6% 0;
      }

      .profile {
        font-size: 25px;
        font-weight: 100;
        margin-top: 20px;
      }

      .hidden_info {
        display: none !important;
      }

      .show_info {
        display: block;
      }
    </style>
    <h1 class="data-header-name">Resumen</h1>

    <p>Selecciona una plantilla:</p>

    <iron-form id="formPrint">
      <form action="/" method="get" class="formPrint">
        <paper-dropdown-menu-light class="grid_start_second_column" name="template" label="Tipo de plantilla" required>
          <paper-listbox slot="dropdown-content" class="dropdown-content" selected={{template}} attr-for-selected="myvalue" required>
            <template is="dom-repeat" items="[[templates]]" as="itemTemplate">
                <paper-item myvalue="[[itemTemplate]]">{{itemTemplate}}</paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu-light>
        <paper-dropdown-menu-light name="printType" label="Formato" required>
          <paper-listbox slot="dropdown-content" class="dropdown-content" selected={{printType}} attr-for-selected="myvalue" required>
            <template is="dom-repeat" items="[[printTypes]]" as="itemsType">
                <paper-item myvalue="[[itemsType]]">{{itemsType}}</paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu-light>
      </form>
    </iron-form>

    <div id="content" class="content">
      <div class="left_column">
        <div class="section_photo">
          <img class="person-img" src="{{profilePic}}" alt="person">
          <div class="profile">[[data.personalInfo.profileStatus]]</div>
        </div>
        <div class$="division_profile division_{{template}}"></div>
        <div class="section_knowledges section">
          <h2 class="title_info-lf">Conocimientos del sector</h2>
          <div class="gray_division"></div>
          <template is="dom-repeat" items="{{data.knowledges}}">
            <p>[[item.knowledge]] - [[item.percent]]</p>
          </template>
        </div>
        <div class="section_languages section">
          <h2 class="title_info-lf">Idiomas</h2>
          <div class="gray_division"></div>
          <template is="dom-repeat" items="{{data.languages}}">
            <p>[[item.name]] - [[item.level]]</p>
          </template>
        </div>
        <div class="section_skills section">
          <h2 class="title_info-lf">Aptitudes interpersonales</h2>
          <div class="gray_division"></div>
          <template is="dom-repeat" items="{{data.skills}}">
            <p>[[item]]</p>
          </template>
        </div>
      </div>
      <div class="right_column">
        <div class$="{{blind}} section_basic-data">
          <div>
            <p>[[data.personalInfo.emails.0]]</p>
            <span class="color_gray">Email</span>
          </div>
          <div>
            <p>[[data.personalInfo.phones.0]]</p>
            <span class="color_gray">Teléfono</span>
          </div>
          <div>
            <p>[[data.personalInfo.userLinkedIn]]</p>
            <span class="color_gray">Linkedin</span>
          </div>
        </div>
        <div class="section_presentation">
          <h1 class="text_bold">Hola.</h1>
          <h1>Soy
            <span class$="color_profile color_{{template}}">
              [[data.personalInfo.userName]] [[data.personalInfo.userSurname]] [[data.personalInfo.userLastname]]
            </span>
          </h1>
          <p>[[data.personalInfo.professionalGoal]]</p>
        </div>
        <div class="orange_division"></div>
        <div class$="{{blind}} section_personal">
          <h2 class="title_info">Información Personal</h2>
          <div class="space_element grid_two_columns">
            <div>
              <span class="color_gray">Curp</span>
              <p>[[data.personalInfo.userCurp]]</p>
              <span class="color_gray">RFC</span>
              <p>[[data.personalInfo.userRFC]]</p>
              <span class="color_gray">Numero Seguro Social</span>
              <p>[[data.personalInfo.userEnsurance]]</p>
              <span class="color_gray">Estado Civil</span>
              <p>[[_getMaritalStatus(data.personalInfo.maritalStatus)]]</p>
              <span class="color_gray">Fecha Nacimiento</span>
              <p>[[data.personalInfo.userBirthday]]</p>
              <span class="color_gray">Sexo</span>
              <p>[[_getSex(data.personalInfo.userSex)]]</p>
            </div>
            <div>
              <span class="color_gray">Calle</span>
              <p>[[data.personalInfo.userAddressStreet]]</p>
              <span class="color_gray">Numero</span>
              <p>[[data.personalInfo.userAddressOutsideNumber]]</p>
              <span class="color_gray">Numero Interior</span>
              <p>[[data.personalInfo.userAddressInsideNumber]]</p>
              <span class="color_gray">Colonia</span>
              <p>[[data.personalInfo.userAddressNeighborhood]]</p>
              <span class="color_gray">Código Postal</span>
              <p>[[data.personalInfo.userAddressPC]]</p>
              <span class="color_gray">Ciudad</span>
              <p>[[data.personalInfo.userAddressCity]]</p>
              <span class="color_gray">Telefonos</span>
              <template is="dom-repeat" items="{{data.personalInfo.phones}}">
                <p>[[item]]</p>
              </template>
            </div>
          </div>
        </div>
        <div class$="{{blind}} orange_division"></div>
        <div class="section_formation">
          <h2 class="title_info">Formación</h2>
          <template is="dom-repeat" items="{{data.formation}}">
            <div class="space_element grid_two_columns">
              <div class="grid_section_rows">
                <span class="color_gray">[[item.institucion]]</span>
                <p>[[item.titulacion]]</p>
              </div>
              <div class="grid_section_rows">
                <span class="color_gray">[[item.desde]] - [[_getacutal(item.actual, item.hasta)]]</span>
                <p>[[item.level]]</p>
              </div>
            </div>
          </template> 
        </div>
        <div class="orange_division"></div>
        <div class="section_courses-certifications">
          <h2 class="title_info">Cursos y Certificaciones</h2>
          <template is="dom-repeat" items="{{data.courses}}">
            <div class="space_element">
              <span class="color_gray">[[item.institucion]] [[item.date]]</span>
              <h3>Curso [[item.name]]</h3>
            </div>
          </template>
          <template is="dom-repeat" items="{{data.certifications}}">
            <div class="space_element">
              <span class="color_gray">[[item.entidad]] [[item.desde]] - [[item.hasta]]</span>
              <h3>Certificación [[item.certificacion]]</h3>
              <p>Licencia número [[item.licencia]] - [[_getPermanence(item.permanente)]]</p>
              <p>[[item.url]]</p>
            </div>
          </template>
        </div>
        <div class="orange_division"></div>
        <div class="section_experience">
          <h2 class="title_info">Experiencia Laboral</h2>
          <template is="dom-repeat" items="{{data.experience}}">
            <div class="space_element">
              <span class="color_gray">[[item.startDate]] - [[_getacutal(item.actual, item.finalDate)]]</span>
              <h3>[[item.position]] - [[item.company]]</h3>
              <p>[[item.description]]</p>
            </div>
          </template>
        </div>
      </div>
    </div>
    <paper-button class="paper-button-k save-and-continue" raised on-click="_downloadCv">Generar PDF</paper-button>
  </template>

  <script>
    /**
     * `my-summary`
     *
     *
     * @customElement
     * @polymer
     *
     */
    class MySummary extends Polymer.Element {
      static get is() { return 'my-summary'; }
      static get properties() {
        return {
          data: {
            type: Object
          },
          templates: {
            type: Array,
            value: ['Agile', 'Development', 'DevOps', 'UX']
          },
          printTypes: {
            type: Array,
            value: ['Básico', 'Completo']
          },
          blind: {
            type: String,
            value: "show_info"
          },
          profilePic: String,
        }
      };

      static get observers() {
        return [
          '_formatSelected(printType)',
        ];
      }

      _formatSelected(newFormat) {
        this.blind = newFormat !== 'Completo' ? 'hidden_info' : 'show_info';
      }

      _getacutal(actual, final) {
        return actual ? "Actual" : final;
      }

      _getPermanence(permanence) {
        return permanence ? "Permanente" : "No permanente";
      }

      _getMaritalStatus(id){
        let maritalStatus = {
          1:"Soltero",
          2:"Casado",
          3:"Divorciado"
        }
        return maritalStatus[id];
      }

      _getSex(id){
        let userSex = {M:"Hombre",W:"Mujer"};
        return userSex[id];
      }

      _downloadCv(event) {
        const validate = this.$.formPrint.validate();
        if (validate) {
          const detail = {
            data: this.data,
            htmlPrint: this.$.content,
            template: this.$.formPrint.serializeForm()
          };
          this._dispatchEvent(event, detail);
        }
      }

      _dispatchEvent(event, detail) {
        this.dispatchEvent(new CustomEvent('download-cv',{
            bubbles: true,
            detail: detail
        }));
      }
    }

    window.customElements.define(MySummary.is, MySummary);
  </script>
</dom-module>
